# Техническое задание по проекту: Построение ML-продукта для выявления и оптимизации платежей преподавателей сервиса Repetit.ru

<b>Цель: </b> Создать ML-продукт, который предсказывает, является ли репетитор мошенником

<b>Используемые для решения задачи данные:</b>

- teacher_info.feather - информация об учителях
- teachers.feather - Статистика по репетиторам и таргет
- lesson_course.featherr - ученики.
- lessons.feather - занятия
- teacher_prices.feather - цены на занятия
- orders.feather - заявки

<b>Задачи:</b>
-  Создать ML-продукт, который предсказывает, является ли репетитор мошенником
-  Избежать утечек данных
-  Создать синтетические признаки
-  
  ### Краткое описание проекта

  В ходе работы над проектом были выполнены следующие основные шаги:
- Ознакомление с данными, агреггирование таблиц
- Работа с пропусками, выбросами и "испорченными" данными. Очистка данных.
- Удаление лишних столбцов (несущих в себе утечку данных и признанных лишними при предварительном анализе)
- Создание искуственных признаков, общих для всей таблицы.
- Создание искуственных признаков, требующих предварительного разделение выборки на обучающую и тестовую
- Поиск лучших гиперпараметров для модели
- Отбор признаков с помощью shap
- Окончательное обучение модели и вывод

  
## Итоговый результат

Мы исследовали датасеты и объединили их. Мы обработали датасет. В финальный датасет вошли не все данные, так как практика показала, что некоторые данные только ухудшают результат. Также мы использовали разные методы для создания искуственных признаков. От некоторых их методов пришлось отказаться, так как они ухудшали результат. 

Было обучено несколько моделей, но было принято решение остановиться на моделе Случайного Леса. Затем, с помощью модуля shap была выстроена иерархия важности признаков. Методом перебора был выявлен оптимальный набор признаков, который позволил получить наилучшие результаты.

В конце концов, мы добились результата 0.63 для метрики f1 и 0.70 для RocAuc
<br>
Кроме того, с помощью shap были выявлены важнейшие для модели признаки.

## Стек
pandas,  numpy, catboost, logisticregression, decision_tree, RandomForest, GridSearchCV, shap

## Состав проекта:
| **Название файла**  | **Содержание**                            |
|:--------------------|:------------------------------------------|
|(https://github.com/AlexReznickenko/repetit_new/blob/main/rep_new_final_1.ipynb)        | основной ноутбук с проектом |
[data] отсутствует в репозитории         | данные для проекта |
 
